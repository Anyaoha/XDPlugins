const{editDocument:editDocument}=require("application"),Usage=require("../../service/UsageService"),ReorderService=require("../../service/ReorderService"),Helpers=require("../../util/helpers");let _TYPE,_ORDER,linkBox,reorderType,reorderOrder,reorderBtn,reorderOptions,repeatGrid,typeOptions,orderOptions,prevOrder=0,changeOrderType=function(){this.selected||(orderOptions.forEach(e=>{e.selected=!1,e.className=""}),this.selected=!0,this.className="selected",_ORDER=this.id)},changeTextType=function(){this.selected||(typeOptions.forEach(e=>{e.selected=!1,e.className=""}),this.selected=!0,this.className="selected",_TYPE=this.id,$all("#reorderOrder > li#ascending > svg").forEach(e=>{e.style.display="none"}),$all("#reorderOrder > li#descending > svg").forEach(e=>{e.style.display="none"}),"text"===_TYPE?($first("#alphaAscSVG").style.display="inline-block",$first("#alphaDescSVG").style.display="inline-block"):"number"===_TYPE?($first("#numAscSVG").style.display="inline-block",$first("#numDescSVG").style.display="inline-block"):($first("#dateAscSVG").style.display="inline-block",$first("#dateDescSVG").style.display="inline-block"),orderOptions.forEach((e,r)=>{_ORDER&&_ORDER===e.id&&(prevOrder=r)}),changeOrderType.call(orderOptions[prevOrder]))},applyReorder=function(){let e=this;this.disabled=!0,editDocument({editLabel:"Reorder Repeat Grid"},r=>{ReorderService.Reorder(repeatGrid,_TYPE,_ORDER,linkBox.checked,e),Usage.ChangePanel("reorder"),Usage.Apply()})};function ReorderPanel(){this.Created=!1}ReorderPanel.prototype.Create=async function(){let e=this;return Helpers.AddCSS("/main.css"),Helpers.AddCSS("/partial/reorder/style.css"),ReorderService.GetView().then(r=>(e.Container=$create("div"),e.Container.innerHTML=r,e.Panel=e.Container.querySelector("#panel"),e.Warning=e.Container.querySelector("#warning"),reorderBtn=e.Container.querySelector("#reorderBtn"),linkBox=e.Container.querySelector("#linkBox"),reorderType=e.Container.querySelector("#reorderType"),reorderOrder=e.Container.querySelector("#reorderOrder"),reorderOptions=e.Container.querySelector("#reorderOptions"),typeOptions=e.Container.querySelectorAll("#reorderType > li"),orderOptions=e.Container.querySelectorAll("#reorderOrder > li"),reorderBtn.disabled=!0,linkBox.disabled=!0,typeOptions.forEach(e=>{e.removeEventListener("click",changeTextType)}),orderOptions.forEach(e=>{e.removeEventListener("click",changeOrderType)}),reorderBtn.removeEventListener("click",applyReorder),e.Created=!0,e.Container))},ReorderPanel.prototype.ChangeItem=function(e){repeatGrid=e,reorderBtn.disabled=!0,linkBox.disabled=!0,reorderBtn.removeEventListener("click",applyReorder),typeOptions.forEach(e=>{e.removeEventListener("click",changeTextType)}),orderOptions.forEach(e=>{e.removeEventListener("click",changeOrderType)}),typeOptions.forEach(e=>{e.selected=!1,e.className=""}),orderOptions.forEach(e=>{e.selected=!1,e.className=""}),_TYPE="",_ORDER="",prevOrder=0,"image"===repeatGrid.selectedItem.type.toLowerCase()?(_TYPE="image",_ORDER="random",reorderBtn.innerHTML="Randomize",reorderOptions.style.display="none"):(reorderBtn.innerHTML="Reorder",reorderOptions.style.display="block",typeOptions.forEach(e=>{e.addEventListener("click",changeTextType)}),orderOptions.forEach(e=>{e.addEventListener("click",changeOrderType)}),changeTextType.call(typeOptions[0])),linkBox.disabled=!1,reorderBtn.disabled=!1,reorderBtn.addEventListener("click",applyReorder)},module.exports=ReorderPanel;